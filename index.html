<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Conversor de Timecodes</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');
    :root{
      --bg:#0d1117; --card:#161b22; --border:#30363d; --fg:#f0f6fc;
      --muted:#c9d1d9; --ok:#238636; --ok2:#2ea043; --info:#1f6feb; --info2:#388bfd; --err:#d73a49;
    }
    *{box-sizing:border-box}
    body{
      font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      margin:0;background:var(--bg);color:var(--fg);
      min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:40px 20px;
    }
    h2{font-size:28px;font-weight:600;margin:0 0 24px}
    .card{
      width:100%;max-width:700px;background:var(--card);border:1px solid var(--border);
      border-radius:12px;box-shadow:0 4px 20px rgba(0,0,0,.4);padding:24px;
    }
    label{display:block;margin:12px 0 6px;color:var(--muted);font-size:14px;font-weight:500}
    input[type="time"], textarea{
      width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:8px;
      background:var(--bg);color:var(--fg);font-size:14px;outline:none;
    }
    textarea{min-height:180px;resize:vertical}
    button{
      width:100%;padding:12px 14px;margin-top:12px;border:none;border-radius:8px;
      font-weight:600;color:#fff;background:var(--ok);cursor:pointer;transition:.2s;
    }
    button:hover{background:var(--ok2)}
    .copy{background:var(--info)} .copy:hover{background:var(--info2)}
    pre{
      margin-top:14px;background:var(--bg);border:1px solid var(--border);
      border-radius:8px;padding:14px;white-space:pre-wrap;font-size:14px;color:var(--fg);
    }
    .toast{
      position:fixed;right:20px;bottom:20px;background:var(--ok);color:#fff;
      padding:12px 16px;border-radius:8px;font-weight:500;font-size:14px;
      opacity:0;transform:translateY(20px);transition:.3s;z-index:1000;pointer-events:none;
      box-shadow:0 8px 20px rgba(0,0,0,.35);
    }
    .toast.show{opacity:1;transform:translateY(0)}
  </style>
</head>
<body>
  <h2>Conversor de Timecodes</h2>
  <div class="card">
    <label>Hora de inicio</label>
    <input type="time" id="horaInicio" value="00:00" />

    <label>Timecodes (ej: 00:00 ARRANCÓ GOLGANAAA)</label>
    <textarea id="input" placeholder="00:00 ARRANCÓ GOLGANAAA
11:42 MUNDO CAMISETAS...
1:08:08 SE VIENE EL CARA A CARA..."></textarea>

    <button id="btnConvertir">Convertir</button>

    <h3 style="margin:18px 0 8px">Resultado:</h3>
    <pre id="output"></pre>
    <button class="copy" id="btnCopiar">Copiar al portapapeles</button>
  </div>

  <div id="toast" class="toast">Copiado al portapapeles ✅</div>

  <script>
    const $ = sel => document.querySelector(sel);

    function showToast(msg, error=false){
      const t = $('#toast');
      t.textContent = msg;
      t.style.background = error ? getComputedStyle(document.documentElement).getPropertyValue('--err') : getComputedStyle(document.documentElement).getPropertyValue('--ok');
      t.classList.add('show');
      setTimeout(()=> t.classList.remove('show'), 2200);
    }

    // Parse "HH:MM" -> segundos desde 00:00
    function parseStart(hhmm){
      const [h,m] = hhmm.split(':').map(n=>parseInt(n||'0',10));
      return (h*60 + m) * 60;
    }

    // Parse timecode:
    //  - "MM:SS" => minutos, segundos
    //  - "H:MM:SS" => horas, minutos, segundos
    //  - "M:SS" también OK (primer bloque como minutos)
    function parseTimecode(tc){
      const parts = tc.split(':').map(x=>x.trim());
      if (parts.length === 2){
        const m = parseInt(parts[0]||'0',10);
        const s = parseInt(parts[1]||'0',10);
        return m*60 + s;
      }
      if (parts.length === 3){
        const h = parseInt(parts[0]||'0',10);
        const m = parseInt(parts[1]||'0',10);
        const s = parseInt(parts[2]||'0',10);
        return h*3600 + m*60 + s;
      }
      // fallback: "MM"
      const m = parseInt(parts[0]||'0',10);
      return m*60;
    }

    function formatHHMM(totalSeconds){
      totalSeconds = Math.max(0, totalSeconds|0);
      const h = Math.floor(totalSeconds / 3600) % 24;
      const m = Math.floor((totalSeconds % 3600) / 60);
      return String(h).padStart(2,'0') + ':' + String(m).padStart(2,'0');
    }

    function convertir(){
      const startStr = $('#horaInicio').value;
      if (!startStr){ showToast('Poné una hora de inicio ❌', true); return; }

      const startSec = parseStart(startStr);
      const lines = $('#input').value.trim().split('\n');
      if (!lines.filter(l=>l.trim()).length){ showToast('Pegá los timecodes ❌', true); return; }

      let out = [];
      for (const raw of lines){
        const linea = raw.trim();
        const m = linea.match(/^(\d{1,3}:\d{2}(?::\d{2})?)\s+(.*)$/); // capta MM:SS o H:MM:SS + texto
        if (!m){ out.push(linea); continue; }
        const tc = m[1];
        const texto = m[2];
        const whenSec = startSec + parseTimecode(tc);
        out.push(`${formatHHMM(whenSec)} ${texto}`);
      }
      $('#output').textContent = out.join('\n');
    }

    function copiar(){
      const txt = $('#output').textContent.trim();
      if (!txt){ showToast('No hay nada para copiar ❌', true); return; }
      navigator.clipboard.writeText(txt).then(()=>showToast('Copiado al portapapeles ✅'));
    }

    $('#btnConvertir').addEventListener('click', convertir);
    $('#btnCopiar').addEventListener('click', copiar);
  </script>
</body>
</html>
